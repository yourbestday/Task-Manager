{"version":3,"sources":["js/main.js"],"names":["checkStatus","response","status","Promise","resolve","reject","Error","statusText","parseJson","json","error","console","log","updateDashboard","fetch","method","then","projects","ul","document","getElementById","innerHTML","result","i","length","progressValue","tasks","ProgressBar","name","dueto","_id","CreateTask","j","createProject","value","headers","body","JSON","stringify","addEventListener","event","getCountComplited","count","Math","round","parent","target","parentElement","id","getAttribute","tagName","divs","querySelectorAll","removeAttribute","newTask","querySelector","selectPriority","priority","options","selectedIndex","selectAssign","assignto","catch","setAttribute","assign","assignName","buttons","statusForm","setTask","parceInt","project","push","generateId","floor","random"],"mappings":"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","file":"main.51054036.map","sourceRoot":"..","sourcesContent":["function checkStatus(response) {\n  if (response.status >= 200 && response.status < 300) {\n    return Promise.resolve(response);\n  } else {\n    return Promise.reject(new Error(response.statusText));\n  }\n}\n\nfunction parseJson(response) {\n  return response.json(); // Далее будем использовать только JSON из тела ответа\n}\n\nfunction error(error) {\n  console.log('Request failed', error);\n}\n\nfunction updateDashboard () {\n  fetch('http://localhost:3000/projects', {\n    method: 'GET'\n  })\n  .then(parseJson)\n  .then(function (projects) {\n    var ul = document.getElementById(\"list\");\n    ul.innerHTML = '';\n    var result = '';\n    for (var i=0; i<projects.length; i++) {\n      result += '<input type=\"checkbox\" id=\"checkbox_'+ i +'\"><li>';\n      //projects[i].id = generateId();\n      //var id = 'project'+i;\n      result += '<div class=\"project\"><label for=\"checkbox_'+ i +'\">';\n      var progressValue;\n      //if project have task,then add checkbox for view task and set status of project\n      if (projects[i].tasks.length != 0){\n        result += '<span class=\"open\">▼</span><span class=\"close\">▲</span></label>';\n        progressValue  = ProgressBar(projects[i].tasks);\n      } else {\n        result += '</label>';\n        progressValue = '0%';\n      }\n\n      result += '<div class=\"progress\"><div id=\"progress\"><div id=\"bar\" style=\"width:'+ progressValue +'\"><div class=\"barText\">'+ progressValue +'</div></div></div></div>';\n      result += '<div class=\"nameProject\">'+ projects[i].name +'</div>';\n      result += '<div class=\"titlePriority\"><div class=\"priorityProject\"></div></div>';\n      result += '<div class=\"deadlineProject\">'+ projects[i].dueto +'</div><div class=\"createSubtask\"><a href=\"#\" class=\"tip\" data-id=\"'+ projects[i]._id +'\">+<span>Create Subtask</span></a></div></div></li>';\n      result += CreateTask (projects[i]._id);\n      if (projects[i].tasks.length !=0){\n        result +='<ul class=\"ListSubTask\">';\n        var tasks = projects[i].tasks;\n        for (var j=0; j<tasks.length; j++) {\n          result += CreateTask (tasks[j]);\n        }\n        result +='</ul>';\n      }\n    }\n    ul.innerHTML = result;\n  });\n  //console.log(result);\n\n};\nupdateDashboard ();\n\nfunction createProject () {\n  var name = document.getElementById(\"CreateNameProject\").value;\n  var dueto = '2018-08-08';\n  var tasks = [];\n  fetch('http://localhost:3000/projects', {\n    method: 'POST',\n    headers: {'Content-Type': 'application/json'},\n    body: JSON.stringify( {'name': name,'dueto': dueto,'tasks': tasks})\n  })\n  .then(parseJson)\n  .then(function (projects) {});\n}\ndocument.getElementById(\"createProject\").addEventListener('click', function(event) {\n  createProject();\n  updateDashboard ();\n});\n\nfunction getCountComplited (tasks) {\n  var count = 0;\n  for( var i=0; i<tasks.length; i++){\n    if (tasks[i].status === 'completed'){\n      count++;\n    }\n  }\n  return count;\n}\nfunction ProgressBar (tasks) {\n  var value = Math.round(getCountComplited (tasks)/tasks.length *100);\n  //var bar = document.getElementById(\"bar\");\n  return value +'%';\n}\n//----------------------------------------------------------------------\ndocument.getElementById(\"list\").addEventListener('click', function(event) {\n\n  // console.log(parent);\n  var parent = event.target.parentElement;\n  parent = parent.parentElement;\n  var id = parent.getAttribute('data-id');\n  if (event.target.tagName == 'A') {\n    //get id from custom button and show form for New Task by id\n    var id = event.target.getAttribute('data-id');\n    var divs = document.querySelectorAll('.new');\n    for (var i=0; i<divs.length; i++){\n      if (divs[i].getAttribute('data-id') == id ) {\n        divs[i].removeAttribute('style');\n      }\n    }\n  }\n  //get data from form check for Validate and set to projects\n  if (event.target.tagName == 'BUTTON') {\n    if (event.target.name == 'createButton') {\n      var newTask = {};\n\n      newTask.name = document.querySelector('#newTaskInput').value;\n      var selectPriority= document.querySelector('#priority');\n      newTask.priority = selectPriority.options[selectPriority.selectedIndex].value;\n      var selectAssign = document.querySelector('#assignChoose');\n      newTask.assignto = selectAssign.options[selectAssign.selectedIndex].value;\n      newTask.dueto = document.querySelector('#dateInput').value;\n      //setTask(id,newTask);\n      fetch('http://localhost:3000/project/tasks/'+id, {\n        method: 'PATCH',\n        headers: {'Content-Type': 'application/json'},\n        body: JSON.stringify( {'tasks': newTask} )\n      })\n      .then(checkStatus)\n      .then(parseJson)\n      // .then(function(data) {\n      //   getTodo();\n      // })\n      .catch(error);\n    }\n    if (event.target.name == 'cancelButton') {\n      parent.setAttribute('style','display:none');\n    }\n  }\n  //console.log(event.target.tagName);\n});\n\n\nfunction CreateTask (tasks) {\n  var result = '';\n  var status;\n  var name;\n  var priority;\n  var assign;\n  var dueto;\n  var assignName;\n  var buttons='';\n  var statusForm = '';\n  if ( typeof(tasks) != \"string\") {\n    status = tasks.status;\n    name = tasks.name;\n    priority = '<div class=\"priorityProject '+ tasks.priority +'\">'+ tasks.priority +'</div>';\n    dueto = tasks.dueto;\n    assignName = tasks.assignto;\n    assign = assignName.name ? assignName.name : '';\n    //assign += '<div class=\"photoProfile small\"></div>';\n  } else {\n    status = 'new';\n    statusForm = 'style=\"display:none;\" data-id=\"'+tasks+'\"';\n    name = '<input type=\"text\" placeholder=\"Task Name\" class=\"newTaskInput\" name=\"newTaskInput\" id=\"newTaskInput\">';\n    priority = '<select size=\"1\" name=\"priority\" id=\"priority\"><option value=\"low\" class=\"low\">low</option><option selected value=\"normal\" class=\"normal\">normal</option><option value=\"high\" class=\"high\">high</option></select>';\n    assign = '<div class=\"priorityProject\"><select size=\"1\" name=\"assignto\" id=\"assignChoose\"><option value=\"1\">Svitlana</option><option value=\"2\">Den</option></select></div>';\n    dueto = '<input type=\"date\" id=\"dateInput\"';\n    buttons ='<div class=\"buttons\"><button name=\"createButton\">Create</button><button name=\"cancelButton\">Cancel</button></div>';\n  }\n\n  result += '<li><div class=\"task '+ status +'\"'+ statusForm +'><div class=\"taskStatus '+status+'Icon\"><a href=\"#\" class=\"tip\"><span>'+status+'</span></a></div>';\n  result += '<div class=\"nameTask\">'+name+'</div>';\n  result += '<div class=\"titlePriority\">'+priority+'</div>';\n  result += '<div class=\"assignName\">'+ assign +'</div>';\n  result += '<div class=\"deadlineProject\">'+ dueto +'</div></div>'+ buttons +'</li>';\n\n  return result;\n}\n//---------------------------------------------\nfunction setTask(id,newTask) {\n  // for (var i=0; i<projects.length; i++){\n  //   if (projects[i].id === id){\n  //     var project = projects[i];\n  //     project.tasks.push(newTask);\n  //     break;\n  //   }\n  // }\n  var i = parceInt(id);\n  var project = projects[i];\n  project.tasks.push(newTask);\n}\n//----------------------------------------------\nfunction generateId() {\n  return ''+Math.floor(Math.random() * (1000 + 1));\n}\n"]}